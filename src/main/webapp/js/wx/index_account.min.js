function earlyLoad(){if(xsyUser&&localStorage.getItem(xsyUser.id)){var t=JSON.parse(localStorage.getItem(xsyUser.id));t.accountList&&t.accountList.accListData&&(accListByData(t.accountList.accListData),pageNo=0)}}function accountSearchDateTypelist(){var t=GetQueryString("searchDateType");$.ajax({type:"post",url:apppath+"/wx/account/dolist.action",data:{pageNo:pageNo,pagesize:pageSize,searchDateType:t},dataType:"json",async:!0,success:function(t){if(console.log(t),$(".load-shadow").hide(),0==t.success)t.entity&&t.entity.status&&"0000003"==t.entity.status?location.href=apppath+"/wx/authorized/no.action?"+ddcommparams:myAlert("网络不给力，请重新加载");else if(0==t.entity.totalSize)$("#content").append(reminderHtml);else{if(xsyUser){var e;localStorage.getItem(xsyUser.id)?(e=JSON.parse(localStorage.getItem(xsyUser.id)),e.accountList={accListData:t}):e={accountList:{accListData:t}},localStorage.setItem(xsyUser.id,JSON.stringify(e))}accListByData(t)}},error:function(){myAlert("网络不给力，请重新加载")}})}function earlyLoad(){if(xsyUser&&localStorage.getItem(xsyUser.id)){var t=JSON.parse(localStorage.getItem(xsyUser.id));t.accountList&&t.accountList.accListData&&(accListByData(t.accountList.accListData),pageNo=0)}}function accListByData(t){arr=[];for(var e=0,a=t.entity.records.length;a>e;e++)arr.push(t.entity.records[e]);if(0==t.entity.records.length){var o=$('<div class="content-reminder"><div class="ico"><p>暂无数据</p></div></div>');$("#list").append(o)}else build_list(arr);console.log($("#list").find(".con").length),$("#list").find(".con").length<t.entity.totalSize?($("#loading").remove(),build_end("加载更多","load_more"),pageNo+=1,loaded()):$("#loading").remove()}function scroll_load(){$("#content").on("scroll",function(){loaded()})}function build_list(t){for(var e,a=0,o=t.length;o>a;a++){e=/(?!^(\d+|[~!@#$%^&*?]+)$)^[\w~!@#$%\^&*?]+$/.test(t[a].accountName_py.substr(0,1))?t[a].accountName_py.substr(0,1):"#";var i,c=$("#list").find('div[id="'+e.toUpperCase()+'"]');if(c.size())i=c.parent();else{if(0==a){var n=$("<li></li>"),s=$('<div class="top boxSizing" id="'+e.toUpperCase()+'">'+e.toUpperCase()+"</div>");n.append(s)}else if(e!=t[a-1].accountName_py.substr(0,1)&&!/^\d$/.test(t[a].accountName_py.substr(0,1))){var n=$("<li></li>"),s=$('<div class="top boxSizing" id="'+e.toUpperCase()+'">'+e.toUpperCase()+"</div>");n.append(s)}$("#list").append(n),i=$("#list > li:last")}listAccountId=t[a].id,listAccountName=t[a].accountName;var r=document.createElement("div");$(r).attr("value",listAccountId),r.className="con boxSizing",$(r).append($('<div class="info" > <span class="accountName">'+listAccountName+'</span><em class="sign_in"></em></div>')),$(r).find("em").on("click",function(t){location.href=apppath+"/wx/activityrecord/qiandao.action?"+ddcommparams+"&belongId=1&objectId="+$(this).parent().parent().attr("value")+"&activityTypeId="+activeRecordTypeOje.SIGN_IN+"&from=acc_info&accountId="+$(this).parent().parent().attr("value"),t.stopPropagation()}),i.append(r)}con_click()}function con_click(){$("#list li div.con").each(function(t){$(this).click(function(){var t=$(this).attr("value"),e=$(this).find("span.accountName").text();local_set(t,e,1),location.href=apppath+"/wx/account/info.action?"+ddcommparams+"&accountId="+t})})}function local_set(t,e,a){if(1==a||2==a){var o={id:t,name:e,kindle:a};if(localStorage.getItem(userId)){var i=JSON.parse(localStorage.getItem(userId));if(i.accountHistory){for(var c=0;c<i.accountHistory.length;c++)i.accountHistory[c].id==t&&i.accountHistory.remove(c);i.accountHistory.push(o)}else var i={accountHistory:[o]}}else var i={accountHistory:[o]}}else if(3==a){var o={id:t,name:e};if("undefined"!=localStorage.getItem(userId)){var i=JSON.parse(localStorage.getItem(userId));if(i.opportunityHistory){for(var c=0;c<i.opportunityHistory.length;c++)i.opportunityHistory[c].id==t&&i.opportunityHistory.remove(c);i.opportunityHistory.push(o)}else var i={opportunityHistory:[o]}}else var i={opportunityHistory:[o]}}localStorage.setItem(userId,JSON.stringify(i))}function build_end(t,e){var a=$('<div id="'+e+'" class="end_info">'+t+"</div>");$("#list").append(a)}function loaded(){myScroll=new IScroll("#content",{probeType:3,mouseWheel:!0,preventDefault:!1,scrollbars:!0,momentum:!0,useTransform:!1,click:!0,tap:!0,bounceTime:200,mouseWheelSpeed:200}),myScroll.on("scrollStart",function(){$("#load_more").length>0&&($("#load_more").remove(),build_end("加载中…","loading"),accountSearchDateTypelist())}),myScroll.on("scrollEnd",function(){$("#loading").remove()})}$(function(){accountSearchDateTypelist()});var pageNo=0,pageSize=20,arr=[],reminderHtml='<div class="content-reminder"><div class="ico"><p>暂无数据</p></div></div>',listAccountId,listAccountName,userId=xsyUser.id,myScroll;